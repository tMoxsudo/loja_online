{% extends "base.html" %}
{% block title %}Confirmação de Pedido{% endblock %}

{% block content %}
<div class="container" style="max-width: 720px;">
    
    <div class="alert alert-success text-center p-4" role="alert">
        <h2 class="alert-heading"><i class="fas fa-check-circle fa-2x mb-3"></i><br>Pedido Finalizado!</h2>
        <p>Obrigado pela sua compra. Seu pedido será processado assim que o pagamento for confirmado.</p>
    </div>

    <div class="card shadow-sm mt-4">
        <div class="card-header">
            <h5 class="mb-0"><i class="fas fa-receipt me-2"></i>Detalhes do Pagamento</h5>
        </div>
        <div class="card-body p-4">
            
            <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Método Escolhido:</span>
                <span class="fw-bold text-uppercase">{{ forma }}</span>
            </div>
            <div class="d-flex justify-content-between h4">
                <span class="fw-bold">Total:</span>
                <span class="fw-bold" style="color: var(--cor-primaria);">R$ {{ "%.2f"|format(total) }}</span>
            </div>

            {% if forma == 'pix' and pix_info %}
                <hr class="my-3">
                <h5 style="color: var(--cor-primaria);"><i class="fas fa-qrcode me-2"></i> Pagamento PIX</h5>
                <p class="text-muted">Escaneie o QR Code ou use o código Copia e Cola:</p>
                
                <div class="text-center my-3">
                    <img src="{{ pix_info.qr_url }}" alt="QR Code PIX Simulado" class="img-thumbnail" style="width: 200px; height: 200px;"/>
                </div>
                
                <label for="pix_code" class="form-label fw-bold">Código Copia e Cola:</label>
                <div class="input-group">
                    <input type="text" id="pix_code" class="form-control" value="{{ pix_info.code }}" readonly>
                    <button class="btn btn-outline-secondary" type="button" onclick="copiarPix()">
                        <i class="fas fa-copy me-1"></i> Copiar
                    </button>
                </div>
            {% endif %}
            
        </div>
    </div>
    
    <div class="text-center mt-4">
        <a href="{{ url_for('index') }}" class="btn btn-success btn-lg fw-bold">
            <i class="fas fa-store me-2"></i>
            Voltar à Loja
        </a>
    </div>

</div>

<script>
    function copiarPix() {
        const input = document.getElementById('pix_code');
        input.select();
        input.setSelectionRange(0, 99999); // Para mobile
        
        try {
            document.execCommand('copy');
            alert('Código PIX copiado para a área de transferência!');
        } catch (err) {
            alert('Não foi possível copiar o código.');
        }
    }
</script>
{% endblock %}